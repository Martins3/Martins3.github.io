# how src

```CMAKE
	SET(gensim-components "module,arch,decode,disasm,ee_interp,ee_blockjit,jumpinfo,function,makefile")
	SET(gensim-component-options "decode.GenerateDotGraph=1,makefile.libtrace_path=${libtrace-includes},makefile.archsim_path=${archsim-includes},makefile.llvm_path=${archsim-llvm-includes},makefile.Optimise=${MODEL_OPT},makefile.Debug=1")
```

It determine what will generate for
1. /home/maritns3/core/captive-project/gensim/gensim/src/generators/MakefileGenerator.cpp

```cpp
class ModuleDescriptorGenerator : public GenerationComponent
{
public:
  ModuleDescriptorGenerator(GenerationManager &man);

  bool Generate() const override;

  virtual const std::vector<std::string> GetSources() const;
  std::string GetFunction() const override;
};
```

- ModuleDescriptorGenerator <==== GenerationComponent


## /home/maritns3/core/captive-project/gensim/gensim/src/generators/ArchDescriptorGenerator.cpp

```cpp
    for(auto i : rfile.GetSlots()) {

    for(auto i : rfile.GetBanks()) {
```

- RegisterFileDescriptor
  - RegisterFileEntryDescriptor
- MemoryInterfacesDescriptor
  - MemoryInterfaceDescriptor

- FeatureDescriptor


trace log of it:
```plain
[DECODE] Building decode tree for ISA arm...done - 1477 nodes
[DECODE] Optimising tree...done - 1518 nodes
[DECODE] Building decode tree for ISA thumb...ISA Conflict detected: rsbit1 and alu_neg overlap.
done - 965 nodes
[DECODE] Optimising tree...done - 1000 nodes
error: unimplemented intrinsic:
s_b_0_2 = flush_itlb_entry
error: unimplemented intrinsic:
s_b_0_2 = flush_dtlb_entry
```

https://stackoverflow.com/questions/10638130/what-is-the-arm-thumb-instruction-set


Most tricky part is generated by :
```cpp
 GenCInterpreterGenerator::GenerateExecuteBodyFor(str, *(gensim::genc::ssa::SSAFormAction*)action);
```

**class SSAContext**
**class SSAActionBase**

class Disposable
- class SSAActionBase
  - SSAActionBase
    - SSAFormAction

## /home/maritns3/core/captive-project/gensim/gensim/src/generators/GenCInterpreter
- used for generate C language

```cpp
			class SSANodeWalker
			{
			public:
				const SSAStatement &Statement;
				SSAWalkerFactory &Factory;

				SSANodeWalker(const SSAStatement &_statement, SSAWalkerFactory &_factory);
				virtual ~SSANodeWalker();

				virtual bool EmitFixedCode(util::cppformatstream &output, std::string end_label /* = 0 */, bool fully_fixed) const = 0;
				virtual bool EmitDynamicCode(util::cppformatstream &output, std::string end_label /* = 0 */, bool fully_fixed) const = 0;
				virtual std::string GetDynamicValue() const;
				virtual std::string GetFixedValue() const;
			};

			class SSAWalkerFactory
			{
			public:
				virtual ~SSAWalkerFactory();

				virtual SSANodeWalker *Create(const SSAStatement *statement) = 0;

				SSANodeWalker *GetOrCreate(const SSAStatement *statement);

			protected:
				void RegisterWalker(const SSAStatement *statement, SSANodeWalker *node);

			private:
				std::map<const SSAStatement *, SSANodeWalker *> _walkers;
			};
		}

```

class SSAGenCWalker : public SSANodeWalker : 23 derives

## /home/maritns3/core/captive-project/gensim/gensim/src/generators/GenCJIT
- used for genearte llvm code ? Oh, I know, this is used for optimized code.

src/generators/GenCJIT/DynamicTranslationGenerator.cpp : some hard coded for generate LLVM

```cpp
			bool EmitFixedFunction(util::cppformatstream &cfile, genc::ssa::SSAFormAction &action, std::string name_prefix /* = "Execute_" */) const;
      bool EmitDynamicEmitter(util::cppformatstream &cfile, util::cppformatstream &hstream, const genc::ssa::SSAFormAction &action, std::string name_prefix /* = "Execute_" */) const;

		class DynamicTranslationGenerator : public TranslationGenerator
```
